type: object
description: |-
  Contains details about a malware policy.
  
x-akamai:
  file-path: schemas/malware-policy.yaml
additionalProperties: false
required:
- name
- hostnames
- paths
properties:
  id:
    type: integer
    description: |
      Uniquely identifies each malware policy.
    readOnly: true
  name:
    type: string
    description: |
      The name you assign to a malware policy.
  description:
    type: string
    description: |
      Descriptive text you provide about a policy.
  paths:
    type: array
    description: |
      The paths to match. You can use the `?` and `*` wildcards anywhere in a path.
    items:
      type: string
  allowListId:
    type: string
    description: |
      The ID of a client list containing file hashes of specific files to allow.
  blockListId:
    type: string
    description: |
      The ID of a client list containing file hashes of specific files to block.
  contentTypes:
    type: array
    description: |
      The content types and encodings to match.
    items:
      type: object
      additionalProperties: false
      required:
      - name
      properties:
        name:
          type: string
          description: |
            The name of the content type.
        encodedContentAttributes:
          type: array
          description: |
            An optional list of encoded attribute paths.
          items:
            type: object
            additionalProperties: false
            properties:
              encoding:
                type: array
                description: |
                  The encodings used for the attribute path. Currently only `base64` is supported.
                items:
                  type: string
                  enum:
                  - base64
              path:
                type: string
                description: |
                  The JSONPath to an attribute with encoded content. The path must point to a single item, and may not include the `$`, `..`, `?` or `*` operators.
  hostnames:
    type: array
    description: |
      The hostnames to match. This is where you want the malware detections to focus.
    items:
      type: string
  logFilename:
    type: boolean
    description: |
      Whether to log the name of the file that triggered an `alert` or `deny` action.
    default: false
